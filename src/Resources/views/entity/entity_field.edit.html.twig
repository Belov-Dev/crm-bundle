{% extends '@A2CRM/layout.html.twig' %}

{% block content %}
    {{ form_start(form) }}
    <div class="row">
        <div class="col-sm-5">
            {{ form_row(form.name) }}
            {{ form_row(form.type) }}

            <div id="form-configuration" hidden></div>

            {{ form_row(form.submit) }}
            </div>
    </div>
    {{ form_end(form) }}
{% endblock %}

{% block javascript %}
    {{ parent() }}
    <script>
        $(function(){
            $('#entity_field_type_form_type').on('change', function(){
                let url = '/admin/crm/entity/{{ entity.id }}/field/edit-configuration/' + $(this).val() + '{% if entityField.id is defined %}/{{ entityField.id }}{% endif %}';
                console.log(url);

                $.post(url, {}, function(result){
                    if(result.hasConfiguration){
                        $('#form-configuration').html(result.html).slideDown(400);
                    }else{
                        $('#form-configuration').slideUp(400, function(){
                            $(this).html('');
                        });
                    }
                });

            }).change();
        })
    </script>
{% endblock %}